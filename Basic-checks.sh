#!/bin/bash

# Define color codes
normal="\e[0m"
red="\e[31m"
green="\e[32m"
orange="\e[33m"
blue="\e[34m"
lightgreen="\e[92m"

# Display script purpose
echo -e "${orange}# Tool for running Cors Scanner, Subjack, and Nuclei using the ${lightgreen}full path${orange} of the file.${normal}"

# Function to run Cors_Scan
run_cors_scan() {
    echo -e "${lightgreen}Cors_Scan is Running...${normal}"
    cd /home/kali/Tools/CORScanner || { echo -e "${red}Failed to navigate to CORScanner directory${normal}"; exit 1; }
    echo -e "\n-----------------Cors_Scan------------------\n" > /home/kali/automated/vuln.txt
    python3 cors_scan.py -i "$1" -t 70 | tee -a /home/kali/automated/vuln.txt
    cd - > /dev/null || { echo -e "${red}Failed to return to the previous directory${normal}"; exit 1; }
}

# Function to run Subjack
run_subjack() {
    echo -e "${lightgreen}Subjack is Running...${normal}"
    echo -e "\n------------------Subjack-------------------\n" >> /home/kali/automated/vuln.txt
    subjack -w "$1" -v | tee /home/kali/automated/temp_subjack.txt
    grep -v "Not" /home/kali/automated/temp_subjack.txt >> /home/kali/automated/vuln.txt
    rm /home/kali/automated/temp_subjack.txt
}

# Function to run Nuclei
run_nuclei() {
    echo -e "${lightgreen}Nuclei is Running...${normal}"
    local templates_dir="/home/kali/.local/nuclei-templates"

    echo -e "\n----------------Nuclei-Vuln-----------------\n" >> /home/kali/automated/vuln.txt
    nuclei -l "$1" -t "$templates_dir/cnvd" >> /home/kali/automated/vuln.txt

    echo -e "\n----------------Nuclei-File-----------------\n" >> /home/kali/automated/vuln.txt
    nuclei -l "$1" -t "$templates_dir/file" >> /home/kali/automated/vuln.txt

    echo -e "\n----------------Nuclei-Technologies-----------------\n" >> /home/kali/automated/vuln.txt
    nuclei -l "$1" -t "$templates_dir/technologies" >> /home/kali/automated/vuln.txt

    echo -e "\n----------------Nuclei-Vulnerabilities-----------------\n" >> /home/kali/automated/vuln.txt
    nuclei -l "$1" -t "$templates_dir/vulnerabilities" >> /home/kali/automated/vuln.txt
}

# Run the functions with the provided file path as an argument
run_cors_scan "$1"
run_subjack "$1"
run_nuclei "$1"
